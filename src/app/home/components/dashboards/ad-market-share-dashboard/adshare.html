}

// 5. Market Concentration Analysis (Lorenz Curve-style)
function createConcentrationChart() {
const sortedData = [...processedData].sort((a, b) => a.totalPercent - b.totalPercent);
let cumulative = 0;
const concentrationData = sortedData.map((d, i) => {
cumulative += d.totalPercent;
return {
provider: d.domain,
rank: i + 1,
percent: d.totalPercent,
cumulative: cumulative
};
});

const margin = {top: 40, right: 50, bottom: 80, left: 80};
const width = 700 - margin.left - margin.right;
const height = 400 - margin.bottom - margin.top;

const svg = d3.select('#concentration-chart')
.append('svg')
.attr('width', width + margin.left + margin.right)
.attr('height', height + margin.top + margin.bottom);

const g = svg.append('g')
.attr('transform', `translate(${margin.left}, ${margin.top})`);

const x = d3.scaleLinear()
.domain([1, concentrationData.length])
.range([0, width]);

const y = d3.scaleLinear()
.domain([0, d3.max(concentrationData, d => d.cumulative)])
.range([height, 0]);

// Draw the concentration curve
const line = d3.line()
.x(d => x(d.rank))
.y(d => y(d.cumulative))
.curve(d3.curveMonotoneX);

const path = g.append('path')
.datum(concentrationData)
.attr('fill', 'none')
.attr('stroke', colors.google)
.attr('stroke-width', 3)
.attr('d', line);

// Add points
g.selectAll('.conc-point')
.data(concentrationData)
.enter().append('circle')
.attr('class', 'conc-point')
.attr('cx', d => x(d.rank))
.attr('cy', d => y(d.cumulative))
.attr('r', d => d.provider === 'google.com' ? 8 : 4)
.attr('fill', d => d.provider === 'google.com' ? colors.google : '#ff6b6b')
.attr('stroke', '#fff')
.attr('stroke-width', 2)
.on('mouseover', function(event, d) {
tooltip.transition().duration(200).style('opacity', 1);
tooltip.html(`<strong>${d.provider}</strong><br />Rank: ${d.rank}<br />Individual: ${d.percent.
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DV360 Ad Distribution Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #3498db, #8e44ad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.2em;
        }

        .viz-container {
            margin-bottom: 50px;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .viz-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .viz-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            pointer-events: none;
            font-size: 14px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #34495e;
            font-weight: 500;
        }

        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 3px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.3);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        svg {
            display: block;
            margin: 0 auto;
        }

        .axis {
            font-size: 12px;
        }

        .axis-label {
            font-size: 14px;
            font-weight: 500;
        }

        .bar:hover {
            opacity: 0.8;
            cursor: pointer;
        }

        .arc:hover {
            opacity: 0.8;
            cursor: pointer;
        }

        .bubble:hover {
            stroke-width: 3px;
            cursor: pointer;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .viz-container {
            animation: fadeIn 0.6s ease forwards;
        }

        .viz-container:nth-child(even) {
            animation-delay: 0.2s;
        }

        .viz-container:nth-child(odd) {
            animation-delay: 0.4s;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>DV360 Ad Distribution Analysis</h1>
        <p class="subtitle">Interactive visualization of advertising domain market share and distribution patterns</p>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">20</div>
                <div class="stat-label">Unique Domains</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">86.5%</div>
                <div class="stat-label">Google Average Share</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">13.5%</div>
                <div class="stat-label">Other Providers</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">3</div>
                <div class="stat-label">Data Columns</div>
            </div>
        </div>

        <div class="viz-container">
            <div class="viz-title">üéØ Top 10 Ad Providers Market Share</div>
            <div id="pie-chart"></div>
        </div>

        <div class="viz-container">
            <div class="viz-title">üìä Top 15 Ad Providers by Combined Market Share</div>
            <div id="bar-chart"></div>
        </div>

        <div class="viz-container">
            <div class="viz-title">üîç Market Distribution Bubble Chart</div>
            <div id="bubble-chart"></div>
        </div>

        <div class="viz-container">
            <div class="viz-title">üìà Stacked Distribution Across Three Data Columns</div>
            <div id="column-comparison"></div>
        </div>

        <div class="viz-container">
            <div class="viz-title">üèÜ Market Concentration Analysis</div>
            <div id="concentration-chart"></div>
        </div>

        <div class="viz-container">
            <div class="viz-title">üì° Provider Consistency Across Columns</div>
            <div id="consistency-chart"></div>
        </div>
    </div>

    <script>
        // Data processing
        const rawData = [
            { domain: "google.com", percent: 78.3, column: "Column 1" },
            { domain: "smartadserver.com", percent: 5.7, column: "Column 1" },
            { domain: "rubiconproject.com", percent: 4.8, column: "Column 1" },
            { domain: "indexexchange.com", percent: 1.6, column: "Column 1" },
            { domain: "yoav.com", percent: 1.3, column: "Column 1" },
            { domain: "pubmatic.com", percent: 1.3, column: "Column 1" },
            { domain: "openx.com", percent: 1.1, column: "Column 1" },
            { domain: "ironarc.com", percent: 1.0, column: "Column 1" },
            { domain: "inmobi.com", percent: 0.6, column: "Column 1" },
            { domain: "triplelift.com", percent: 0.6, column: "Column 1" },
            { domain: "themediarigid.com", percent: 0.6, column: "Column 1" },
            { domain: "sovrn.com", percent: 0.4, column: "Column 1" },
            { domain: "appnexus.com", percent: 0.3, column: "Column 1" },
            { domain: "onetag.com", percent: 0.2, column: "Column 1" },
            { domain: "media.net", percent: 0.2, column: "Column 1" },

            { domain: "google.com", percent: 88.2, column: "Column 2" },
            { domain: "rubiconproject.com", percent: 0.5, column: "Column 2" },
            { domain: "sovrn.com", percent: 0.3, column: "Column 2" },
            { domain: "indexexchange.com", percent: 0.2, column: "Column 2" },
            { domain: "pubmatic.com", percent: 0.2, column: "Column 2" },
            { domain: "yieldmo.com", percent: 0.1, column: "Column 2" },
            { domain: "appnexus.com", percent: 0.1, column: "Column 2" },
            { domain: "contextweb.com", percent: 0.1, column: "Column 2" },
            { domain: "smartadserver.com", percent: 0.1, column: "Column 2" },
            { domain: "themediarigid.com", percent: 0.1, column: "Column 2" },

            { domain: "google.com", percent: 82.1, column: "Column 3" },
            { domain: "pubmatic.com", percent: 4.0, column: "Column 3" },
            { domain: "indexexchange.com", percent: 4.0, column: "Column 3" },
            { domain: "openx.com", percent: 3.9, column: "Column 3" },
            { domain: "smartadserver.com", percent: 2.4, column: "Column 3" },
            { domain: "onetag.com", percent: 1.3, column: "Column 3" },
            { domain: "rubiconproject.com", percent: 1.0, column: "Column 3" },
            { domain: "appnexus.com", percent: 0.5, column: "Column 3" },
            { domain: "xandr.com", percent: 0.2, column: "Column 3" },
            { domain: "media.net", percent: 0.1, column: "Column 3" },
            { domain: "yahoo.com", percent: 0.1, column: "Column 3" },
            { domain: "adform.com", percent: 0.1, column: "Column 3" }
        ];

        // Aggregate data
        const aggregatedData = {};
        rawData.forEach(item => {
            if (aggregatedData[item.domain]) {
                aggregatedData[item.domain] += item.percent;
            } else {
                aggregatedData[item.domain] = item.percent;
            }
        });

        const processedData = Object.entries(aggregatedData)
            .map(([domain, totalPercent]) => ({
                domain,
                totalPercent: parseFloat(totalPercent.toFixed(1)),
                category: domain === 'google.com' ? 'Google' : 'Other'
            }))
            .sort((a, b) => b.totalPercent - a.totalPercent);

        // Color schemes
        const colors = {
            google: '#4285f4',
            others: d3.scaleOrdinal()
                .range(['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dda0dd', '#98d8c8',
                    '#f7dc6f', '#bb8fce', '#85c1e9', '#f8c471', '#82e0aa', '#f1948a', '#85c1e9'])
        };

        // Tooltip
        const tooltip = d3.select('body').append('div').attr('class', 'tooltip').style('opacity', 0);

        // 1. Pie Chart - Top 10 providers (showing individual providers instead of just Google vs Others)
        function createPieChart() {
            const top10 = processedData.slice(0, 10);
            const othersSum = processedData.slice(10).reduce((sum, d) => sum + d.totalPercent, 0);

            const pieData = [
                ...top10.map(d => ({
                    label: d.domain.replace('.com', ''),
                    value: d.totalPercent,
                    color: d.domain === 'google.com' ? colors.google : colors.others(d.domain)
                })),
                { label: 'Others', value: othersSum, color: '#95a5a6' }
            ];

            const width = 500;
            const height = 500;
            const radius = Math.min(width, height) / 2 - 50;

            const svg = d3.select('#pie-chart')
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const g = svg.append('g')
                .attr('transform', `translate(${width / 2}, ${height / 2})`);

            const pie = d3.pie().value(d => d.value).sort(null);
            const arc = d3.arc().innerRadius(0).outerRadius(radius);

            const arcs = g.selectAll('.arc')
                .data(pie(pieData))
                .enter().append('g')
                .attr('class', 'arc');

            arcs.append('path')
                .attr('d', arc)
                .attr('fill', d => d.data.color)
                .style('opacity', 0.9)
                .style('stroke', '#fff')
                .style('stroke-width', 2)
                .on('mouseover', function (event, d) {
                    d3.select(this).transition().duration(200).style('opacity', 0.7);
                    tooltip.transition().duration(200).style('opacity', 1);
                    tooltip.html(`<strong>${d.data.label}</strong><br/>Market share: ${d.data.value.toFixed(1)}%`)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 28) + 'px');
                })
                .on('mouseout', function () {
                    d3.select(this).transition().duration(200).style('opacity', 0.9);
                    tooltip.transition().duration(200).style('opacity', 0);
                });

            // Add labels for larger segments
            arcs.append('text')
                .attr('transform', d => `translate(${arc.centroid(d)})`)
                .attr('text-anchor', 'middle')
                .style('font-size', d => d.data.value > 10 ? '14px' : '10px')
                .style('font-weight', 'bold')
                .style('fill', d => d.data.value > 50 ? 'white' : '#333')
                .text(d => d.data.value > 3 ? `${d.data.value.toFixed(1)}%` : '');

            // Legend with better layout
            const legend = d3.select('#pie-chart')
                .append('div')
                .style('display', 'grid')
                .style('grid-template-columns', 'repeat(3, 1fr)')
                .style('gap', '10px')
                .style('margin-top', '20px');

            pieData.forEach(d => {
                const item = legend.append('div').attr('class', 'legend-item');
                item.append('div')
                    .attr('class', 'legend-color')
                    .style('background-color', d.color);
                item.append('span').text(d.label);
            });
        }

        // 2. Bar Chart - Top 15 providers
        function createBarChart() {
            const top15 = processedData.slice(0, 15);
            const margin = { top: 20, right: 30, bottom: 80, left: 60 };
            const width = 1000 - margin.left - margin.right;
            const height = 500 - margin.bottom - margin.top;

            const svg = d3.select('#bar-chart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left}, ${margin.top})`);

            const x = d3.scaleBand()
                .rangeRound([0, width])
                .paddingInner(0.1)
                .domain(top15.map(d => d.domain));

            const y = d3.scaleLinear()
                .rangeRound([height, 0])
                .domain([0, d3.max(top15, d => d.totalPercent)]);

            // Bars
            g.selectAll('.bar')
                .data(top15)
                .enter().append('rect')
                .attr('class', 'bar')
                .attr('x', d => x(d.domain))
                .attr('width', x.bandwidth())
                .attr('y', height)
                .attr('height', 0)
                .attr('fill', d => d.domain === 'google.com' ? colors.google : colors.others(d.domain))
                .on('mouseover', function (event, d) {
                    tooltip.transition().duration(200).style('opacity', 1);
                    tooltip.html(`<strong>${d.domain}</strong><br/>Combined share: ${d.totalPercent}%`)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 28) + 'px');
                })
                .on('mouseout', function () {
                    tooltip.transition().duration(200).style('opacity', 0);
                })
                .transition()
                .duration(1000)
                .delay((d, i) => i * 50)
                .attr('y', d => y(d.totalPercent))
                .attr('height', d => height - y(d.totalPercent));

            // X axis
            g.append('g')
                .attr('class', 'axis')
                .attr('transform', `translate(0, ${height})`)
                .call(d3.axisBottom(x))
                .selectAll('text')
                .style('text-anchor', 'end')
                .attr('dx', '-.8em')
                .attr('dy', '.15em')
                .attr('transform', 'rotate(-45)');

            // Y axis
            g.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y));

            g.append('text')
                .attr('class', 'axis-label')
                .attr('transform', 'rotate(-90)')
                .attr('y', -40)
                .attr('x', -height / 2)
                .style('text-anchor', 'middle')
                .text('Combined Market Share (%)');
        }

        // 3. Bubble Chart with adjusted scales
        function createBubbleChart() {
            const margin = { top: 40, right: 40, bottom: 80, left: 100 };
            const width = 900 - margin.left - margin.right;
            const height = 600 - margin.bottom - margin.top;

            const svg = d3.select('#bubble-chart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left}, ${margin.top})`);

            // Better scaling for bubble chart
            const x = d3.scalePoint()
                .domain(processedData.map((d, i) => i))
                .range([0, width])
                .padding(0.1);

            const y = d3.scaleLinear()
                .domain([0, d3.max(processedData, d => d.totalPercent) * 1.1])
                .range([height, 0]);

            const size = d3.scalePow()
                .exponent(0.6)
                .domain([d3.min(processedData, d => d.totalPercent), d3.max(processedData, d => d.totalPercent)])
                .range([8, 60]);

            // Add grid lines
            g.selectAll('.grid-line')
                .data(y.ticks(8))
                .enter().append('line')
                .attr('class', 'grid-line')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', d => y(d))
                .attr('y2', d => y(d))
                .style('stroke', '#e0e0e0')
                .style('stroke-dasharray', '3,3');

            g.selectAll('.bubble')
                .data(processedData)
                .enter().append('circle')
                .attr('class', 'bubble')
                .attr('cx', (d, i) => x(i))
                .attr('cy', d => y(d.totalPercent))
                .attr('r', 0)
                .attr('fill', d => d.domain === 'google.com' ? colors.google : colors.others(d.domain))
                .style('opacity', 0.8)
                .attr('stroke', '#fff')
                .attr('stroke-width', 2)
                .on('mouseover', function (event, d) {
                    d3.select(this).transition().duration(200).attr('stroke-width', 4);
                    tooltip.transition().duration(200).style('opacity', 1);
                    tooltip.html(`<strong>${d.domain}</strong><br/>Market share: ${d.totalPercent}%<br/>Rank: ${processedData.indexOf(d) + 1}`)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 28) + 'px');
                })
                .on('mouseout', function () {
                    d3.select(this).transition().duration(200).attr('stroke-width', 2);
                    tooltip.transition().duration(200).style('opacity', 0);
                })
                .transition()
                .duration(1500)
                .delay((d, i) => i * 50)
                .attr('r', d => size(d.totalPercent));

            // Y axis with better formatting
            g.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y).tickFormat(d => d + '%'));

            g.append('text')
                .attr('class', 'axis-label')
                .attr('transform', 'rotate(-90)')
                .attr('y', -60)
                .attr('x', -height / 2)
                .style('text-anchor', 'middle')
                .style('font-size', '14px')
                .text('Market Share (%)');

            g.append('text')
                .attr('class', 'axis-label')
                .attr('y', height + 50)
                .attr('x', width / 2)
                .style('text-anchor', 'middle')
                .style('font-size', '14px')
                .text('Ad Providers (Ranked by Market Share)');

            // Add domain labels for top providers
            g.selectAll('.bubble-label')
                .data(processedData.filter((d, i) => i < 8))
                .enter().append('text')
                .attr('class', 'bubble-label')
                .attr('x', (d, i) => x(processedData.indexOf(d)))
                .attr('y', height + 25)
                .style('text-anchor', 'middle')
                .style('font-size', '10px')
                .style('fill', '#666')
                .text(d => d.domain.replace('.com', '').substring(0, 8));
        }

        // 4. Stacked Bar Chart for Column Comparison
        function createColumnComparison() {
            // Prepare data for stacking - get top 8 providers plus "Others"
            const top8Domains = processedData.slice(0, 8).map(d => d.domain);

            const stackData = ['Column 1', 'Column 2', 'Column 3'].map(column => {
                const columnData = rawData.filter(d => d.column === column);
                const result = { column };

                // Add top 8 providers
                top8Domains.forEach(domain => {
                    const found = columnData.find(d => d.domain === domain);
                    result[domain] = found ? found.percent : 0;
                });

                // Add "Others" category
                const top8Total = top8Domains.reduce((sum, domain) => {
                    const found = columnData.find(d => d.domain === domain);
                    return sum + (found ? found.percent : 0);
                }, 0);
                const columnTotal = columnData.reduce((sum, d) => sum + d.percent, 0);
                result['Others'] = columnTotal - top8Total;

                return result;
            });

            const keys = [...top8Domains, 'Others'];
            const stack = d3.stack().keys(keys);
            const series = stack(stackData);

            const margin = { top: 20, right: 120, bottom: 50, left: 80 };
            const width = 700 - margin.left - margin.right;
            const height = 500 - margin.bottom - margin.top;

            const svg = d3.select('#column-comparison')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left}, ${margin.top})`);

            const x = d3.scaleBand()
                .domain(stackData.map(d => d.column))
                .range([0, width])
                .padding(0.1);

            const y = d3.scaleLinear()
                .domain([0, d3.max(series, d => d3.max(d, d => d[1]))])
                .range([height, 0]);

            const color = d3.scaleOrdinal()
                .domain(keys)
                .range([colors.google, '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dda0dd', '#98d8c8', '#95a5a6']);

            // Create stacked bars
            g.selectAll('.layer')
                .data(series)
                .enter().append('g')
                .attr('class', 'layer')
                .attr('fill', d => color(d.key))
                .selectAll('rect')
                .data(d => d)
                .enter().append('rect')
                .attr('x', d => x(d.data.column))
                .attr('width', x.bandwidth())
                .attr('y', height)
                .attr('height', 0)
                .on('mouseover', function (event, d) {
                    const key = d3.select(this.parentNode).datum().key;
                    const value = d[1] - d[0];
                    tooltip.transition().duration(200).style('opacity', 1);
                    tooltip.html(`<strong>${key}</strong><br/>${d.data.column}<br/>Share: ${value.toFixed(1)}%`)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 28) + 'px');
                })
                .on('mouseout', function () {
                    tooltip.transition().duration(200).style('opacity', 0);
                })
                .transition()
                .duration(1000)
                .delay((d, i) => i * 100)
                .attr('y', d => y(d[1]))
                .attr('height', d => y(d[0]) - y(d[1]));

            // Axes
            g.append('g')
                .attr('class', 'axis')
                .attr('transform', `translate(0, ${height})`)
                .call(d3.axisBottom(x));

            g.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y).tickFormat(d => d + '%'));

            g.append('text')
                .attr('class', 'axis-label')
                .attr('transform', 'rotate(-90)')
                .attr('y', -50)
                .attr('x', -height / 2)
                .style('text-anchor', 'middle')
                .text('Market Share (%)');

            // Legend
            const legend = g.selectAll('.legend-item-stack')
                .data(keys.slice().reverse())
                .enter().append('g')
                .attr('class', 'legend-item-stack')
                .attr('transform', (d, i) => `translate(${width + 20}, ${i * 25})`);

            legend.append('rect')
                .attr('width', 18)
                .attr('height', 18)
                .attr('fill', d => color(d));

            legend.append('text')
                .attr('x', 25)
                .attr('y', 9)
                .attr('dy', '0.35em')
                .style('font-size', '12px')
                .text(d => d === 'google.com' ? 'Google' : d.replace('.com', ''));
        }

        // Initialize all visualizations
        setTimeout(() => {
            createPieChart();
            createBarChart();
            createBubbleChart();
            createColumnComparison();
        }, 500);
    </script>
</body>

</html>